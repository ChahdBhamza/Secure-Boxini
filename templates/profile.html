<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureBox - Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-950 text-slate-50">
    <div class="min-h-screen">
        <!-- Header -->
        <div class="border-b border-slate-800 bg-slate-900/50 backdrop-blur-sm sticky top-0 z-10">
            <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <a href="{{ url_for('dashboard') }}"
                        class="flex items-center gap-3 hover:opacity-80 transition-opacity">
                        <div
                            class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-400 to-cyan-400 flex items-center justify-center">
                            <svg class="w-6 h-6 text-slate-950" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3v-6">
                                </path>
                            </svg>
                        </div>
                        <h1 class="text-xl font-semibold">SecureBox</h1>
                    </a>
                </div>
                <div class="flex items-center gap-4">
                    <a href="{{ url_for('dashboard') }}"
                        class="text-slate-400 hover:text-slate-50 text-sm font-medium transition-colors">
                        Dashboard
                    </a>
                    <a href="{{ url_for('logout') }}"
                        class="text-slate-400 hover:text-slate-50 px-4 py-2 rounded-lg hover:bg-slate-800 transition-colors text-sm font-medium">
                        Logout
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="max-w-4xl mx-auto px-6 py-12">

            <!-- Profile Section -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-8 mb-12">
                <div class="flex items-start gap-8">
                    <!-- Profile Picture -->
                    <div class="flex-shrink-0">
                        <div
                            class="w-32 h-32 rounded-full bg-slate-800 border-4 border-slate-700 overflow-hidden relative group">
                            {% if user.profile_pic and user.profile_pic != 'default.png' %}
                            <img src="{{ url_for('uploaded_file', filename=user.profile_pic) }}" alt="Profile"
                                class="w-full h-full object-cover">
                            {% else %}
                            <div class="w-full h-full flex items-center justify-center bg-slate-800 text-slate-600">
                                <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            {% endif %}

                            <!-- Upload Overlay -->
                            <label
                                class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                    </path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <form action="{{ url_for('profile') }}" method="POST" enctype="multipart/form-data"
                                    id="profile-pic-form">
                                    <input type="file" name="profile_pic" class="hidden"
                                        onchange="document.getElementById('profile-pic-form').submit()">
                                </form>
                            </label>
                        </div>
                    </div>

                    <!-- User Info -->
                    <div class="flex-1 pt-2">
                        <h2 class="text-3xl font-bold text-white mb-2">{{ user.username }}</h2>
                        <p class="text-slate-400 mb-4">{{ user.email }}</p>
                        <div class="flex gap-2">
                            <span
                                class="px-3 py-1 rounded-full bg-blue-500/10 text-blue-400 text-xs font-medium border border-blue-500/20">
                                Member since {{ user.created_at.strftime('%b %Y') if user.created_at else 'N/A' }}
                            </span>
                            {% if user.is_verified %}
                            <span
                                class="px-3 py-1 rounded-full bg-green-500/10 text-green-400 text-xs font-medium border border-green-500/20">
                                Verified
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Flash Messages -->
            {% if error %}
            <div class="bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg mb-8">
                {{ error }}
            </div>
            {% endif %}
            {% if success %}
            <div class="bg-green-500/10 border border-green-500/20 text-green-400 px-4 py-3 rounded-lg mb-8">
                {{ success }}
            </div>
            {% endif %}

            <!-- Security Section -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-8 mb-12">
                <h3 class="text-xl font-semibold text-white mb-6 flex items-center gap-2">
                    <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
                        </path>
                    </svg>
                    Security
                </h3>
                <form action="{{ url_for('change_password') }}" method="POST" class="max-w-md">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-1">Current Password</label>
                            <input type="password" name="current_password" required
                                class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 transition-colors">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-1">New Password</label>
                            <input type="password" name="new_password" required
                                class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 transition-colors">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-400 mb-1">Confirm New Password</label>
                            <input type="password" name="confirm_password" required
                                class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-blue-500 transition-colors">
                        </div>
                        <button type="submit"
                            class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                            Change Password
                        </button>
                    </div>
                </form>
            </div>

            <!-- Activity Logs Section -->
            <div>
                <h3 class="text-xl font-semibold text-white mb-6 flex items-center gap-2">
                    <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Activity Logs
                </h3>

                <div class="bg-slate-900/50 border border-slate-800 rounded-xl overflow-hidden">
                    {% if logs %}
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-slate-900/80 text-slate-400 text-xs uppercase font-semibold">
                                <tr>
                                    <th class="px-6 py-4">Action</th>
                                    <th class="px-6 py-4">Details</th>
                                    <th class="px-6 py-4">Date & Time</th>
                                    <th class="px-6 py-4 text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-800">
                                {% for log in logs %}
                                <tr class="hover:bg-slate-800/50 transition-colors group">
                                    <td class="px-6 py-4 text-slate-300 font-medium">{{ log.action }}</td>
                                    <td class="px-6 py-4 text-slate-400 text-sm">{{ log.details or '-' }}</td>
                                    <td class="px-6 py-4 text-slate-500 text-sm font-mono">{{
                                        log.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                                    <td class="px-6 py-4 text-right">
                                        <a href="{{ url_for('delete_log', log_id=log._id) }}"
                                            class="text-slate-500 hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100"
                                            title="Delete Log">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                                </path>
                                            </svg>
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="p-12 text-center text-slate-500">
                        <p>No activity logs found.</p>
                    </div>
                    {% endif %}
                </div>
            </div>

        </div>
    </div>
</body>

</html>